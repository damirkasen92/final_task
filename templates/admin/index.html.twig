{% extends 'base.html.twig' %}

{% block title %} {{ 'admin.title'|trans }} {% endblock %}

{% block body %}

    <div class="admin-wrapper p-2">
        <h1 class="mb-3">{{ 'admin.title'|trans }}</h1>

        <div class="admin-toolbar flex-row gap-2 mb-4"
             data-controller="admin-panel"
             data-popover-title="{{ 'admin.buttons.popover_title'|trans }}"
             data-popover-btn="{{ 'admin.buttons.undo'|trans }}"
        >
            <button type="button" class="btn btn-secondary my-1"
                    data-action="click->admin-panel#block"
                    data-src="{{ path('admin_block') }}"
            >
                {{ 'admin.buttons.block'|trans }}
            </button>
            <button type="button" class="btn btn-secondary my-1"
                    data-action="click->admin-panel#unblock"
                    data-src="{{ path('admin_unblock') }}"
            >
                {{ 'admin.buttons.unblock'|trans }}
            </button>
            <button type="button" class="btn btn-secondary my-1"
                    data-action="click->admin-panel#delete"
                    data-src="{{ path('admin_delete') }}"
            >
                {{ 'admin.buttons.delete'|trans }}
            </button>
            <button type="button" class="btn btn-secondary my-1"
                    data-action="click->admin-panel#makeAdmin"
                    data-src="{{ path('admin_make_admin') }}"
            >
                {{ 'admin.buttons.make_admin'|trans }}
            </button>
            <button type="button" class="btn btn-secondary my-1"
                    data-action="click->admin-panel#unmakeAdmin"
                    data-src="{{ path('admin_unmake_admin') }}"
            >
                {{ 'admin.buttons.unmake_admin'|trans }}
            </button>
        </div>

        <div class="admin-user-table">
            <div class="table-responsive">
                <turbo-frame id="admin-table" src="{{ path('admin_table') }}">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>
                                <input
                                    class="main-checkbox"
                                    type="checkbox" name="check"
                                    data-controller="checkbox"
                                    data-action="click->checkbox#click"
                                >
                            </th>
                            <th>{{ 'admin.table.header.name'|trans }}</th>
                            <th>{{ 'admin.table.header.email'|trans }}</th>
                            <th>{{ 'admin.table.header.role'|trans }}</th>
                            <th>{{ 'admin.table.header.blocked'|trans }}</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for user in users %}
                            <tr>
                                <td>
                                    <input class="sub-checkbox" type="checkbox" name="check"
                                           data-controller="sub-checkbox"
                                           data-action="click->sub-checkbox#click"
                                           data-id="{{ user.id }}"
                                    >
                                </td>
                                <td>{{ user.name }}</td>
                                <td>{{ user.email }}</td>
                                <td>
                                    {% if role_admin in user.roles %}
                                        {{ 'roles.admin'|trans }}
                                    {% else %}
                                        {{ 'roles.user'|trans }}
                                    {% endif %}
                                </td>
                                <td>{{ user.blocked ? 'blocked' : 'free' }}</td>
                            </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </turbo-frame>
            </div>
        </div>
    </div>

{% endblock %}
